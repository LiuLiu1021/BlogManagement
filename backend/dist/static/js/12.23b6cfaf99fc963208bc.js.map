{"version":3,"sources":["webpack:///src/views/messageBoard.vue","webpack:///./src/views/messageBoard.vue?5a06","webpack:///./src/views/messageBoard.vue"],"names":["__webpack_exports__","data","pageMinHeight","source","showCancel","submitting","value","comments","commentInfo","currentPage","pageSize","total","toInfo","userInfo","watch","computed","components","CommentList","__WEBPACK_IMPORTED_MODULE_1__components_CommentList__","CommentBox","__WEBPACK_IMPORTED_MODULE_2__components_CommentBox__","Sticky","__WEBPACK_IMPORTED_MODULE_3__components_Sticky__","created","this","getCommentDataList","mounted","that","window","innerHeight","$","scroll","_this","document","height","scrollTop","length","params","Object","__WEBPACK_IMPORTED_MODULE_4__api_comment__","then","response","code","$ECode","SUCCESS","concat","records","setCommentList","current","size","methods","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","__WEBPACK_IMPORTED_MODULE_5_vuex__","handleCurrentChange","val","submitBox","e","_this2","userUid","content","blogUid","$notify","title","message","type","offset","error","_this3","views_messageBoard","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_m","attrs","on","submit-box","_e","staticRenderFns","href","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent","messageBoard"],"mappings":"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","file":"static/js/12.23b6cfaf99fc963208bc.js","sourcesContent":["\n<template>\n  <div class=\"page\">\n    <div class=\"pagebg ab\"></div>\n    <div class=\"container\">\n      <h1 class=\"t_nav\">\n        <span>每个人都有自己故事，只是演绎的方式不同。</span>\n        <a href=\"/\" class=\"n1\">网站首页</a>\n        <a href=\"/\" class=\"n2\">留言</a>\n      </h1>\n\n        <CommentBox\n          :userInfo=\"userInfo\"\n          :commentInfo=\"commentInfo\"\n          @submit-box=\"submitBox\"\n          :showCancel=\"showCancel\"\n        ></CommentBox>\n\n      <div class=\"message_infos\">\n        <CommentList :comments=\"comments\" :commentInfo=\"commentInfo\"></CommentList>\n        <div class=\"noComment\" v-if=\"comments.length ==0\">还没有评论，快来抢沙发吧！</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n    import CommentList from \"../components/CommentList\";\n    import CommentBox from \"../components/CommentBox\";\n    import Sticky from \"@/components/Sticky\";\n    import { addComment, getCommentList } from \"../api/comment\";\n\n    // vuex中有mapState方法，相当于我们能够使用它的getset方法\n    import { mapMutations } from \"vuex\";\n    export default {\n        data() {\n            return {\n                pageMinHeight: 0,\n                source: \"MESSAGE_BOARD\",\n                showCancel: false,\n                submitting: false,\n                value: \"\",\n                comments: [],\n                commentInfo: {\n                    // 评论来源： MESSAGE_BOARD，ABOUT，BLOG_INFO 等 代表来自某些页面的评论\n                    source: \"MESSAGE_BOARD\"\n                },\n                currentPage: 1,\n                pageSize: 10,\n                total: 0, //总数量\n                toInfo: {},\n                userInfo: {}\n            };\n        },\n        watch: {},\n        computed: {},\n        components: {\n            CommentList,\n            CommentBox,\n            Sticky\n        },\n        created() {\n            this.getCommentDataList();\n        },\n        mounted () {\n          var that = this;\n          // 屏幕的高度\n          this.pageMinHeight = window.innerHeight - 62\n          $(window).scroll(function () {\n            var docHeight = $(document).height(); // 获取整个页面的高度(不只是窗口,还包括为显示的页面)\n            var winHeight = $(window).height(); // 获取当前窗体的高度(显示的高度)\n            var winScrollHeight = $(window).scrollTop(); // 获取滚动条滚动的距离(移动距离)\n            //还有30像素的时候,就查询\n            if(docHeight == winHeight + winScrollHeight){\n              if(that.comments.length >= that.total) {\n                return;\n              }\n              let params = {};\n              params.source = \"MESSAGE_BOARD\";\n              params.currentPage = that.currentPage + 1\n              params.pageSize = that.pageSize;\n              getCommentList(params).then(response => {\n                if (response.code == that.$ECode.SUCCESS) {\n                  that.comments = that.comments.concat(response.data.records);\n                  that.setCommentList(this.comments);\n                  that.currentPage = response.data.current;\n                  that.pageSize = response.data.size;\n                  that.total = response.data.total;\n                }\n              });\n            }\n          })\n        },\n        methods: {\n            //拿到vuex中的写的两个方法\n            ...mapMutations([\"setCommentList\"]),\n            handleCurrentChange: function(val) {\n                this.currentPage = val;\n                this.getCommentDataList();\n            },\n            submitBox(e) {\n                let params = {};\n                params.source = e.source;\n                params.userUid = e.userUid;\n                params.content = e.content;\n                params.blogUid = e.blogUid;\n                addComment(params).then(response => {\n                    if (response.code == this.$ECode.SUCCESS) {\n                        this.$notify({\n                            title: \"成功\",\n                            message: \"发表成功~\",\n                            type: \"success\",\n                            offset: 100\n                        });\n                    } else {\n                        this.$notify.error({\n                            title: \"错误\",\n                            message: response.data,\n                            offset: 100\n                        });\n                    }\n                    this.getCommentDataList();\n                });\n            },\n            getCommentDataList: function() {\n                let params = {};\n                params.source = \"MESSAGE_BOARD\";\n                params.currentPage = this.currentPage;\n                params.pageSize = this.pageSize;\n                getCommentList(params).then(response => {\n                    if (response.code == this.$ECode.SUCCESS) {\n                        this.comments = response.data.records;\n                        this.setCommentList(this.comments);\n                        this.currentPage = response.data.current;\n                        this.pageSize = response.data.size;\n                        this.total = response.data.total;\n                    }\n                });\n            },\n        }\n    };\n</script>\n<style scoped>\n  .message_infos {\n    width: 100%;\n    min-height: 500px;\n    margin-left: 10px;\n  }\n  .noComment {\n    width: 100%;\n    text-align: center;\n  }\n  .page {\n    position: relative;\n  }\n  .block {\n    position: relative;\n    bottom: 0px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/messageBoard.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"pagebg ab\"}),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_vm._m(0),_vm._v(\" \"),_c('CommentBox',{attrs:{\"userInfo\":_vm.userInfo,\"commentInfo\":_vm.commentInfo,\"showCancel\":_vm.showCancel},on:{\"submit-box\":_vm.submitBox}}),_vm._v(\" \"),_c('div',{staticClass:\"message_infos\"},[_c('CommentList',{attrs:{\"comments\":_vm.comments,\"commentInfo\":_vm.commentInfo}}),_vm._v(\" \"),(_vm.comments.length ==0)?_c('div',{staticClass:\"noComment\"},[_vm._v(\"还没有评论，快来抢沙发吧！\")]):_vm._e()],1)],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h1',{staticClass:\"t_nav\"},[_c('span',[_vm._v(\"每个人都有自己故事，只是演绎的方式不同。\")]),_vm._v(\" \"),_c('a',{staticClass:\"n1\",attrs:{\"href\":\"/\"}},[_vm._v(\"网站首页\")]),_vm._v(\" \"),_c('a',{staticClass:\"n2\",attrs:{\"href\":\"/\"}},[_vm._v(\"留言\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1803ed5e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/messageBoard.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1803ed5e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./messageBoard.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./messageBoard.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./messageBoard.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1803ed5e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./messageBoard.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1803ed5e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/messageBoard.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}